# solar-bench

Simple benchmarks across different Solidity parser implementations.

Requires cloning submodules: `git submodule update --init --checkout`.

Run with:

```bash
# Criterion
cargo criterion -p solar-bench --bench criterion -- --quiet --format terse |& tee benches/criterion.out
uv --project benches/analyze run benches/analyze/main.py benches/README.md < benches/criterion.out

# iai - requires `valgrind` and `iai-callgrind-runner`
cargo bench -p solar-bench --bench iai
```

This crate is excluded from the main workspace to avoid compiling it (and its dependencies) when
invoking other commands such as `cargo test`.

## Results

You view the Solar-only results on [codspeed.io](https://codspeed.io/paradigmxyz/solar).

The following results were achieved on:
- Target: `x86_64-unknown-linux-gnu`
- CPU: AMD Ryzen 9 7950X
- Versions:
  - [`solc 0.8.28`](https://github.com/ethereum/solidity)
  - [`solar 0.1.2`](../README.md)
  - [`solang-parser 0.3.4`](https://crates.io/crates/solang-parser)
  - [`slang 0.18.3`](https://crates.io/crates/slang)
  - [`tree-sitter 0.25.4`](https://crates.io/crates/tree-sitter), [`tree-sitter-solidity 1.2.11`](https://crates.io/crates/tree-sitter-solidity)

<!-- AUTOGENERATED MARKER -->

![lex Relative Performance](lex_relative_performance.png)

![parse Relative Performance](parse_relative_performance.png)

### empty (0 LoC, 0 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solang   | 17.71x     | 7.9006 ns | N/A     | N/A       |
| solar    | 1.00x      | 124.30 ns | N/A     | N/A       |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solang      | 38.82x     | 95.535 ns | N/A     | N/A       |
| solar       | 12.72x     | 290.83 ns | N/A     | N/A       |
| tree-sitter | 9.00x      | 410.09 ns | N/A     | N/A       |
| solc        | 3.69x      | 1.0000 µs | N/A     | N/A       |
| slang       | 1.00x      | 3.6882 µs | N/A     | N/A       |

### Counter (14 LoC, 258 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 1.54x      | 968.84 ns | 14.46M  | 266.53M   |
| solang   | 1.00x      | 1.4879 µs | 9.41M   | 173.50M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 71.63x     | 2.6024 µs | 5.38M   | 99.15M    |
| solang      | 22.09x     | 8.4361 µs | 1.66M   | 30.58M    |
| tree-sitter | 15.72x     | 11.853 µs | 1.18M   | 21.77M    |
| solc        | 4.37x      | 42.600 µs | 328.64K | 6.06M     |
| slang       | 1.00x      | 186.37 µs | 75.12K  | 1.38M     |

### verifier (208 LoC, 11040 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 1.84x      | 34.787 µs | 5.98M   | 317.36M   |
| solang   | 1.00x      | 64.032 µs | 3.25M   | 172.41M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 113.00x    | 87.898 µs | 2.37M   | 125.60M   |
| solang      | 21.99x     | 451.72 µs | 460.46K | 24.44M    |
| solc        | 14.64x     | 678.60 µs | 306.51K | 16.27M    |
| tree-sitter | 13.27x     | 748.29 µs | 277.97K | 14.75M    |
| slang       | 1.00x      | 9.9321 ms | 20.94K  | 1.11M     |

### OptimizorClub (782 LoC, 35905 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 1.66x      | 118.70 µs | 6.59M   | 302.49M   |
| solang   | 1.00x      | 197.54 µs | 3.96M   | 181.76M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 102.94x    | 263.52 µs | 2.97M   | 136.25M   |
| solang      | 20.96x     | 1.2942 ms | 604.23K | 27.74M    |
| solc        | 16.23x     | 1.6712 ms | 467.93K | 21.48M    |
| tree-sitter | 12.81x     | 2.1171 ms | 369.37K | 16.96M    |
| slang       | 1.00x      | 27.127 ms | 28.83K  | 1.32M     |

### UniswapV3 (3189 LoC, 146583 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 2.09x      | 312.81 µs | 10.19M  | 468.60M   |
| solang   | 1.00x      | 652.53 µs | 4.89M   | 224.64M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 108.02x    | 679.70 µs | 4.69M   | 215.66M   |
| solang      | 21.95x     | 3.3449 ms | 953.39K | 43.82M    |
| solc        | 15.08x     | 4.8701 ms | 654.81K | 30.10M    |
| tree-sitter | 12.58x     | 5.8384 ms | 546.21K | 25.11M    |
| slang       | 1.00x      | 73.423 ms | 43.43K  | 2.00M     |

### Solarray (1544 LoC, 35898 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 1.40x      | 211.30 µs | 7.31M   | 169.89M   |
| solang   | 1.00x      | 296.39 µs | 5.21M   | 121.12M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 125.77x    | 559.05 µs | 2.76M   | 64.21M    |
| solc        | 28.10x     | 2.5023 ms | 617.03K | 14.35M    |
| solang      | 25.44x     | 2.7635 ms | 558.71K | 12.99M    |
| tree-sitter | 17.04x     | 4.1259 ms | 374.22K | 8.70M     |
| slang       | 1.00x      | 70.310 ms | 21.96K  | 510.57K   |

### console (1552 LoC, 67315 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 1.51x      | 298.24 µs | 5.20M   | 225.71M   |
| solang   | 1.00x      | 450.79 µs | 3.44M   | 149.33M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 113.05x    | 688.41 µs | 2.25M   | 97.78M    |
| solang      | 22.32x     | 3.4873 ms | 445.04K | 19.30M    |
| solc        | 22.07x     | 3.5261 ms | 440.15K | 19.09M    |
| tree-sitter | 14.83x     | 5.2476 ms | 295.75K | 12.83M    |
| slang       | 1.00x      | 77.828 ms | 19.94K  | 864.92K   |

### Vm (1763 LoC, 91405 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 2.25x      | 180.58 µs | 9.76M   | 506.17M   |
| solang   | 1.00x      | 405.80 µs | 4.34M   | 225.25M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 57.44x     | 340.50 µs | 5.18M   | 268.44M   |
| solang      | 13.79x     | 1.4188 ms | 1.24M   | 64.42M    |
| tree-sitter | 8.47x      | 2.3082 ms | 763.80K | 39.60M    |
| solc        | 7.28x      | 2.6855 ms | 656.49K | 34.04M    |
| slang       | 1.00x      | 19.560 ms | 90.13K  | 4.67M     |

### safeconsole (13248 LoC, 397898 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 1.47x      | 1.5889 ms | 8.34M   | 250.42M   |
| solang   | 1.00x      | 2.3360 ms | 5.67M   | 170.33M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 82.75x     | 5.1813 ms | 2.56M   | 76.80M    |
| solang      | 21.49x     | 19.955 ms | 663.89K | 19.94M    |
| tree-sitter | 21.19x     | 20.231 ms | 654.84K | 19.67M    |
| solc        | 19.89x     | 21.555 ms | 614.61K | 18.46M    |
| slang       | 1.00x      | 428.74 ms | 30.90K  | 928.06K   |

### Seaport (19935 LoC, 770547 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 2.15x      | 1.3071 ms | 15.25M  | 589.51M   |
| solang   | 1.00x      | 2.8163 ms | 7.08M   | 273.60M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 99.27x     | 2.5119 ms | 7.94M   | 306.76M   |
| solang      | 24.41x     | 10.217 ms | 1.95M   | 75.42M    |
| solc        | 12.38x     | 20.139 ms | 989.86K | 38.26M    |
| tree-sitter | 12.28x     | 20.308 ms | 981.63K | 37.94M    |
| slang       | 1.00x      | 249.36 ms | 79.94K  | 3.09M     |

### Solady (31047 LoC, 1381235 bytes)

#### Lex
| Parser   | Relative   | Time      | LoC/s   | Bytes/s   |
|:---------|:-----------|:----------|:--------|:----------|
| solar    | 1.70x      | 3.9078 ms | 7.94M   | 353.46M   |
| solang   | 1.00x      | 6.6398 ms | 4.68M   | 208.02M   |

#### Parse
| Parser      | Relative   | Time      | LoC/s   | Bytes/s   |
|:------------|:-----------|:----------|:--------|:----------|
| solar       | 95.89x     | 8.7663 ms | 3.54M   | 157.56M   |
| solang      | 21.90x     | 38.377 ms | 809.00K | 35.99M    |
| solc        | 15.98x     | 52.614 ms | 590.09K | 26.25M    |
| tree-sitter | 15.76x     | 53.330 ms | 582.17K | 25.90M    |
| slang       | 1.00x      | 840.63 ms | 36.93K  | 1.64M     |
